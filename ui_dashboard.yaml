resources:
  - url: /hacsfiles/lovelace-card-mod/card-mod.js
    type: module
  - url: /hacsfiles/lovelace-layout-card/layout-card.js
    type: module
  - url: /hacsfiles/button-card/button-card.js
    type: module
  - url: /hacsfiles/stack-in-card/stack-in-card.js
    type: module
background: center / cover no-repeat url("/local/fond_tablette.webp") fixed
theme: alforis-tablette
device_preference: desktop
button_card_templates:
  base-button:
    size: 100%
    show_state: false
    show_name: true
    show_icon: true
    styles:
      card:
        - background: rgba(255, 255, 255, 0.1)
        - backdrop-filter: blur(20px)
        - border-radius: 12px
        - padding: 8px
        - margin: 4px 0px
        - transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1)
        - box-shadow: 0 2px 8px rgba(0,0,0,0.1)
        - position: relative
        - overflow: hidden
        - height: 60px
        - min-height: 60px
        - max-height: 60px
        - border: 1px solid rgba(255, 255, 255, 0.2)
      icon:
        - width: 24px
        - height: 24px
        - color: white
        - margin-bottom: 6px
        - filter: drop-shadow(0 1px 2px rgba(0,0,0,0.3))
      name:
        - font-size: 11px
        - font-weight: 700
        - color: white
        - text-align: center
        - line-height: 1.1
        - text-shadow: 0 1px 2px rgba(0,0,0,0.5)
        - letter-spacing: 0.2px
    tap_action:
      haptic: medium
    hold_action:
      action: more-info
      haptic: heavy
  piece-button:
    template: base-button
    styles:
      card:
        - background: linear-gradient(135deg, rgba(21,101,192,0.9), rgba(25,118,210,0.8))
        - border: 2px solid rgba(21,101,192,0.7)
  materiel-button:
    template: base-button
    styles:
      card:
        - background: linear-gradient(135deg, rgba(245,127,23,0.9), rgba(255,152,0,0.8))
        - border: 2px solid rgba(245,127,23,0.7)
  scenario-button:
    template: base-button
    styles:
      card:
        - background: linear-gradient(135deg, rgba(156,39,176,0.9), rgba(233,30,99,0.8))
        - border: 2px solid rgba(156,39,176,0.8)
    tap_action:
      haptic: success
  nav-button:
    template: base-button
    show_state: true
    show_last_changed: false
    styles:
      card:
        - background: >-
            linear-gradient(135deg, rgba(var(--rgb-primary-color), 0.8),
            rgba(var(--rgb-accent-color), 0.6))
        - border: 2px solid rgba(var(--rgb-primary-color), 0.5)
views:
  - title: Accueil
    path: accueil
    icon: mdi:home-assistant
    panel: true
    theme: alforis-tablette
    background:
      image: /local/fond_tablette.webp
      size: cover
      alignment: center
      repeat: no-repeat
      attachment: fixed
    card_mod:
      style: |
        /* Configuration PANEL - Utilisation 100% de l'√©cran */
        :host {
          --lovelace-background: transparent;
        }

        /* Panel mode : suppression de toutes les marges */
        hui-view, #view {
          padding: 0 !important;
          margin: 0 !important;
          max-width: none !important;
          width: 100vw !important;
          height: 100vh !important;
        }

        /* Fond transparent sur les cartes principales */
        :host > hui-view > #view > ha-card {
          background: transparent !important;
          box-shadow: none !important;
        }

        /* Override complet des marges par d√©faut de HA */
        .view {
          padding: 0 !important;
          margin: 0 !important;
          max-width: none !important;
          width: 100vw !important;
        }

        /* Optimisation paysage tablette */
        @media (orientation: landscape) {
          hui-view, #view, .view {
            width: 100vw !important;
            max-width: 100vw !important;
            height: 100vh !important;
          }
        }
    cards:
      - type: custom:vertical-stack-in-card
        card_mod:
          style: >
            ha-card { background: transparent !important; box-shadow: none
            !important; }
        cards:
          - type: custom:mod-card
            card_mod:
              style: |
                ha-card {
                  background: transparent;
                  backdrop-filter: blur(20px);
                  padding: 8px 16px;
                  margin: 8px 12px;
                  border-radius: 20px;
                  box-shadow: 0 4px 16px rgba(0,0,0,0.1);
                  border: 1px solid rgba(255, 255, 255, 0.2);
                  min-height: 60px;
                  display: flex;
                  align-items: center;
                }
            card:
              type: horizontal-stack
              cards:
                - type: markdown
                  content: >
                    ## üè† Bonjour {{ user }}

                    *{{ now().strftime('%A %d %B %Y') }} - Maison connect√©e*

                    **üå°Ô∏è {{ states('sensor.temp_salon') }}¬∞C** ‚Ä¢ **‚ö° {{
                    states('sensor.consommation_electrique') }}W**
                  card_mod:
                    style: |
                      ha-card {
                        background: transparent;
                        box-shadow: none;
                        padding: 0;
                        flex: 1;
                      }
                      .card-content { padding: 0 !important; }
                      h2 {
                        margin: 0 0 2px 0;
                        font-size: 18px;
                        background: linear-gradient(45deg, var(--primary-color), var(--accent-color));
                        -webkit-background-clip: text;
                        -webkit-text-fill-color: transparent;
                        line-height: 1.2;
                      }
                      em {
                        font-size: 11px;
                        color: var(--secondary-text-color);
                        display: block;
                        margin-bottom: 2px;
                        line-height: 1.1;
                      }
                      strong {
                        font-size: 10px;
                        color: var(--accent-color);
                        line-height: 1.1;
                      }
                - type: custom:button-card
                  icon: mdi:cog
                  size: 40px
                  show_name: false
                  tap_action:
                    action: navigate
                    navigation_path: /config/dashboard
                  styles:
                    card:
                      - background: rgba(var(--rgb-primary-color),0.1)
                      - border-radius: 12px
                      - width: 40px
                      - height: 40px
                      - margin-left: 12px
                    icon:
                      - color: var(--primary-color)
                      - width: 20px
                      - height: 20px
          - type: markdown
            content: "..."
          - type: horizontal-stack
            cards:
              - type: weather-forecast
                entity: weather.forecast_maison
                show_current: true
                show_forecast: true
                forecast_type: daily
                name: M√©t√©o
                secondary_info_attribute: humidity
                card_mod:
                  style: |
                    ha-card {
                      background: transparent;
                      backdrop-filter: blur(20px);
                      border-radius: 20px;
                      border: 1px solid rgba(255, 255, 255, 0.2);
                      box-shadow: 0 6px 24px rgba(0,0,0,0.1);
                      padding: 12px;
                      margin: 0 12px 12px 8px;
                      flex: 1;
                    }
              - type: custom:mod-card
                card_mod:
                  style: |
                    ha-card {
                      background: transparent;
                      backdrop-filter: blur(20px);
                      border-radius: 20px;
                      border: 1px solid rgba(255, 255, 255, 0.2);
                      box-shadow: 0 6px 24px rgba(0,0,0,0.1);
                      padding: 12px;
                      margin: 0 12px 12px 8px;
                      flex: 2;
                      height: 240px;
                    }
                card:
                  type: vertical-stack
                  cards:
                    - type: markdown
                      content: |
                        ### üå°Ô∏è Climat int√©rieur
                      card_mod:
                        style: |
                          ha-card {
                            background: transparent;
                            box-shadow: none;
                            padding: 0;
                            margin: 0;
                            height: 25px;
                            min-height: 25px;
                          }
                          .card-content {
                            padding: 0 !important;
                            margin: 0 !important;
                          }
                          h3 {
                            margin: 0;
                            padding: 0;
                            background: linear-gradient(90deg, var(--accent-color), var(--primary-color));
                            -webkit-background-clip: text;
                            -webkit-text-fill-color: transparent;
                            font-weight: 700;
                            font-size: 14px;
                            line-height: 1;
                          }
                    - type: grid
                      columns: 3
                      square: false
                      card_mod:
                        style: |
                          hui-grid-card { gap: 8px !important; }
                      cards:
                        - type: custom:button-card
                          template: nav-button
                          entity: sensor.info_climat_adele
                          name: üëß Ad√®le
                          show_state: false
                          custom_fields:
                            info: |
                              [[[
                                const climate_entity = states['climate.adele'];
                                if (!climate_entity) return 'Indisponible';

                                const climate_state = climate_entity.state;
                                const current_temp = climate_entity.attributes.current_temperature;
                                const target_temp = climate_entity.attributes.temperature || '‚Äî';

                                return `<div style="
                                  font-size: 10px;
                                  color: white;
                                  text-align: center;
                                  line-height: 1.3;
                                  display: flex;
                                  flex-direction: column;
                                  justify-content: center;
                                  height: 100%;
                                  padding: 2px;
                                ">
                                  <div style="font-weight: bold; margin-bottom: 1px;">${climate_state.charAt(0).toUpperCase() + climate_state.slice(1)}</div>
                                  <div style="margin-bottom: 1px;">${target_temp}¬∞C</div>
                                  <div style="opacity: 0.7; font-size: 7px; margin-bottom: 1px;">Actuellement:</div>
                                  <div style="font-weight: bold;">${current_temp}¬∞C</div>
                                </div>`;
                              ]]]
                          styles:
                            card:
                              - height: 75px !important
                              - min-height: 75px !important
                            name:
                              - font-size: 15px
                              - margin: 0
                              - padding: 2px 0
                              - position: absolute
                              - top: 2px
                              - left: 0
                              - right: 0
                              - z-index: 10
                            custom_fields:
                              info:
                                - position: absolute
                                - top: 18px
                                - left: 0
                                - right: 0
                                - bottom: 2px
                                - display: flex
                                - align-items: center
                                - justify-content: center
                          tap_action:
                            action: more-info
                            entity: climate.adele
                        - type: custom:button-card
                          template: nav-button
                          entity: sensor.info_climat_alex
                          name: üë¶ Alex
                          show_state: false
                          custom_fields:
                            info: |
                              [[[
                                const climate_entity = states['climate.alex'];
                                if (!climate_entity) return 'Indisponible';

                                const climate_state = climate_entity.state;
                                const current_temp = climate_entity.attributes.current_temperature;
                                const target_temp = climate_entity.attributes.temperature || '‚Äî';

                                return `<div style="
                                  font-size: 8px;
                                  color: white;
                                  text-align: center;
                                  line-height: 1.3;
                                  display: flex;
                                  flex-direction: column;
                                  justify-content: center;
                                  height: 100%;
                                  padding: 2px;
                                ">
                                  <div style="font-weight: bold; margin-bottom: 1px;">${climate_state.charAt(0).toUpperCase() + climate_state.slice(1)}</div>
                                  <div style="margin-bottom: 1px;">${target_temp}¬∞C</div>
                                  <div style="opacity: 0.7; font-size: 7px; margin-bottom: 1px;">Actuellement:</div>
                                  <div style="font-weight: bold;">${current_temp}¬∞C</div>
                                </div>`;
                              ]]]
                          styles:
                            card:
                              - height: 70px !important
                              - min-height: 70px !important
                            name:
                              - font-size: 10px
                              - margin-bottom: 2px
                            custom_fields:
                              info:
                                - position: absolute
                                - top: 20px
                                - left: 0
                                - right: 0
                                - bottom: 0
                                - display: flex
                                - align-items: center
                                - justify-content: center
                          tap_action:
                            action: more-info
                            entity: climate.alex
                        - type: custom:button-card
                          template: nav-button
                          entity: sensor.info_climat_bureau
                          name: üíº Bureau
                          show_state: false
                          custom_fields:
                            info: |
                              [[[
                                const climate_entity = states['climate.bureau'];
                                if (!climate_entity) return 'Indisponible';

                                const climate_state = climate_entity.state;
                                const current_temp = climate_entity.attributes.current_temperature;
                                const target_temp = climate_entity.attributes.temperature || '‚Äî';

                                return `<div style="
                                  font-size: 8px;
                                  color: white;
                                  text-align: center;
                                  line-height: 1.3;
                                  display: flex;
                                  flex-direction: column;
                                  justify-content: center;
                                  height: 100%;
                                  padding: 2px;
                                ">
                                  <div style="font-weight: bold; margin-bottom: 1px;">${climate_state.charAt(0).toUpperCase() + climate_state.slice(1)}</div>
                                  <div style="margin-bottom: 1px;">${target_temp}¬∞C</div>
                                  <div style="opacity: 0.7; font-size: 7px; margin-bottom: 1px;">Actuellement:</div>
                                  <div style="font-weight: bold;">${current_temp}¬∞C</div>
                                </div>`;
                              ]]]
                          styles:
                            card:
                              - height: 70px !important
                              - min-height: 70px !important
                            name:
                              - font-size: 10px
                              - margin-bottom: 2px
                            custom_fields:
                              info:
                                - position: absolute
                                - top: 20px
                                - left: 0
                                - right: 0
                                - bottom: 0
                                - display: flex
                                - align-items: center
                                - justify-content: center
                          tap_action:
                            action: more-info
                            entity: climate.bureau
                        - type: custom:button-card
                          template: nav-button
                          entity: sensor.info_climat_cuisine
                          name: üç≥ Cuisine
                          show_state: false
                          custom_fields:
                            info: |
                              [[[
                                const climate_entity = states['climate.cuisine'];
                                if (!climate_entity) return 'Indisponible';

                                const climate_state = climate_entity.state;
                                const current_temp = climate_entity.attributes.current_temperature;
                                const target_temp = climate_entity.attributes.temperature || '‚Äî';

                                return `<div style="
                                  font-size: 8px;
                                  color: white;
                                  text-align: center;
                                  line-height: 1.3;
                                  display: flex;
                                  flex-direction: column;
                                  justify-content: center;
                                  height: 100%;
                                  padding: 2px;
                                ">
                                  <div style="font-weight: bold; margin-bottom: 1px;">${climate_state.charAt(0).toUpperCase() + climate_state.slice(1)}</div>
                                  <div style="margin-bottom: 1px;">${target_temp}¬∞C</div>
                                  <div style="opacity: 0.7; font-size: 7px; margin-bottom: 1px;">Actuellement:</div>
                                  <div style="font-weight: bold;">${current_temp}¬∞C</div>
                                </div>`;
                              ]]]
                          styles:
                            card:
                              - height: 70px !important
                              - min-height: 70px !important
                            name:
                              - font-size: 10px
                              - margin-bottom: 2px
                            custom_fields:
                              info:
                                - position: absolute
                                - top: 20px
                                - left: 0
                                - right: 0
                                - bottom: 0
                                - display: flex
                                - align-items: center
                                - justify-content: center
                          tap_action:
                            action: more-info
                            entity: climate.cuisine
                        - type: custom:button-card
                          template: nav-button
                          entity: sensor.info_climat_entree
                          name: üì∫ Entr√©e & TV
                          show_state: false
                          custom_fields:
                            info: |
                              [[[
                                const climate_entity = states['climate.entree_tv'];
                                if (!climate_entity) return 'Indisponible';

                                const climate_state = climate_entity.state;
                                const current_temp = climate_entity.attributes.current_temperature;
                                const target_temp = climate_entity.attributes.temperature || '‚Äî';

                                return `<div style="
                                  font-size: 8px;
                                  color: white;
                                  text-align: center;
                                  line-height: 1.3;
                                  display: flex;
                                  flex-direction: column;
                                  justify-content: center;
                                  height: 100%;
                                  padding: 2px;
                                ">
                                  <div style="font-weight: bold; margin-bottom: 1px;">${climate_state.charAt(0).toUpperCase() + climate_state.slice(1)}</div>
                                  <div style="margin-bottom: 1px;">${target_temp}¬∞C</div>
                                  <div style="opacity: 0.7; font-size: 7px; margin-bottom: 1px;">Actuellement:</div>
                                  <div style="font-weight: bold;">${current_temp}¬∞C</div>
                                </div>`;
                              ]]]
                          styles:
                            card:
                              - height: 70px !important
                              - min-height: 70px !important
                            name:
                              - font-size: 10px
                              - margin-bottom: 2px
                            custom_fields:
                              info:
                                - position: absolute
                                - top: 20px
                                - left: 0
                                - right: 0
                                - bottom: 0
                                - display: flex
                                - align-items: center
                                - justify-content: center
                          tap_action:
                            action: more-info
                            entity: climate.entree_tv
                        - type: custom:button-card
                          template: nav-button
                          entity: sensor.info_climat_parents
                          name: üõèÔ∏è Parents
                          show_state: false
                          custom_fields:
                            info: |
                              [[[
                                const climate_entity = states['climate.parents'];
                                if (!climate_entity) return 'Indisponible';

                                const climate_state = climate_entity.state;
                                const current_temp = climate_entity.attributes.current_temperature;
                                const target_temp = climate_entity.attributes.temperature || '‚Äî';

                                return `<div style="
                                  font-size: 8px;
                                  color: white;
                                  text-align: center;
                                  line-height: 1.3;
                                  display: flex;
                                  flex-direction: column;
                                  justify-content: center;
                                  height: 100%;
                                  padding: 2px;
                                ">
                                  <div style="font-weight: bold; margin-bottom: 1px;">${climate_state.charAt(0).toUpperCase() + climate_state.slice(1)}</div>
                                  <div style="margin-bottom: 1px;">${target_temp}¬∞C</div>
                                  <div style="opacity: 0.7; font-size: 7px; margin-bottom: 1px;">Actuellement:</div>
                                  <div style="font-weight: bold;">${current_temp}¬∞C</div>
                                </div>`;
                              ]]]
                          styles:
                            card:
                              - height: 70px !important
                              - min-height: 70px !important
                            name:
                              - font-size: 10px
                              - margin-bottom: 2px
                            custom_fields:
                              info:
                                - position: absolute
                                - top: 20px
                                - left: 0
                                - right: 0
                                - bottom: 0
                                - display: flex
                                - align-items: center
                                - justify-content: center
                          tap_action:
                            action: more-info
                            entity: climate.parents
          - type: custom:mod-card
            card_mod:
              style: |
                ha-card {
                  background: transparent !important;
                  backdrop-filter: blur(20px);
                  border-radius: 20px;
                  border: 1px solid rgba(255, 255, 255, 0.2);
                  box-shadow: 0 6px 24px rgba(0,0,0,0.1);
                  padding: 12px;
                  margin: 8px 12px 12px 12px;
                  height: calc(100vh - 420px);
                  min-height: 280px;
                }
            card:
              type: horizontal-stack
              cards:
                - type: vertical-stack
                  cards:
                    - type: markdown
                      content: '### üè† **Pi√®ces**'
                      card_mod:
                        style: |
                          ha-card {
                            background: transparent;
                            box-shadow: none;
                            text-align: center;
                            padding: 0 0 4px 0;
                          }
                          h3 {
                            margin: 0;
                            background: linear-gradient(90deg, var(--primary-color), var(--accent-color));
                            -webkit-background-clip: text;
                            -webkit-text-fill-color: transparent;
                            font-weight: 700;
                            font-size: 14px;
                          }
                    - type: custom:button-card
                      template: piece-button
                      name: üè† RDC
                      icon: mdi:home-floor-0
                      tap_action:
                        action: navigate
                        navigation_path: /lovelace/rdc
                    - type: custom:button-card
                      template: piece-button
                      name: üè† R+1
                      icon: mdi:home-floor-1
                      tap_action:
                        action: navigate
                        navigation_path: /lovelace/etage1
                      styles:
                        card:
                          - background: >-
                              linear-gradient(135deg, rgba(25, 118, 210, 0.9),
                              rgba(33, 150, 243, 0.8))
                          - border: 2px solid rgba(25, 118, 210, 0.7)
                    - type: custom:button-card
                      template: piece-button
                      name: üè† R+2
                      icon: mdi:home-floor-2
                      tap_action:
                        action: navigate
                        navigation_path: /lovelace/etage2
                      styles:
                        card:
                          - background: >-
                              linear-gradient(135deg, rgba(33, 150, 243, 0.9),
                              rgba(66, 165, 245, 0.8))
                          - border: 2px solid rgba(33, 150, 243, 0.7)
                - type: vertical-stack
                  cards:
                    - type: markdown
                      content: '### üß∞ **Mat√©riel**'
                      card_mod:
                        style: |
                          ha-card {
                            background: transparent;
                            box-shadow: none;
                            text-align: center;
                            padding: 0 0 8px 0;
                          }
                          h3 {
                            margin: 0;
                            background: linear-gradient(90deg, var(--accent-color), var(--primary-color));
                            -webkit-background-clip: text;
                            -webkit-text-fill-color: transparent;
                            font-weight: 700;
                          }
                    - type: custom:button-card
                      template: materiel-button
                      name: ü™ü Volets
                      icon: mdi:window-shutter
                      tap_action:
                        action: navigate
                        navigation_path: /lovelace/volets
                    - type: custom:button-card
                      template: materiel-button
                      name: üå°Ô∏è Temp√©rature
                      icon: mdi:thermometer
                      tap_action:
                        action: navigate
                        navigation_path: /lovelace/temperature
                      styles:
                        card:
                          - background: >-
                              linear-gradient(135deg, rgba(255, 152, 0, 0.9),
                              rgba(255, 193, 7, 0.8))
                          - border: 2px solid rgba(255, 152, 0, 0.7)
                    - type: custom:button-card
                      template: materiel-button
                      name: üîå √âlectrom√©nager
                      icon: mdi:washing-machine
                      tap_action:
                        action: navigate
                        navigation_path: /lovelace/electromenager
                      styles:
                        card:
                          - background: >-
                              linear-gradient(135deg, rgba(255, 193, 7, 0.9),
                              rgba(255, 235, 59, 0.8))
                          - border: 2px solid rgba(255, 193, 7, 0.7)
                    - type: custom:button-card
                      template: materiel-button
                      name: üåø Ext√©rieur
                      icon: mdi:pine-tree
                      tap_action:
                        action: navigate
                        navigation_path: /lovelace/exterieur
                      styles:
                        card:
                          - background: >-
                              linear-gradient(135deg, rgba(139, 195, 74, 0.9),
                              rgba(156, 204, 101, 0.8))
                          - border: 2px solid rgba(139, 195, 74, 0.7)
                - type: vertical-stack
                  cards:
                    - type: markdown
                      content: '### üé¨ **Sc√©narios**'
                      card_mod:
                        style: |
                          ha-card {
                            background: transparent;
                            box-shadow: none;
                            text-align: center;
                            padding: 0 0 8px 0;
                          }
                          h3 {
                            margin: 0;
                            background: linear-gradient(90deg, var(--secondary-color), var(--accent-color));
                            -webkit-background-clip: text;
                            -webkit-text-fill-color: transparent;
                            font-weight: 700;
                          }
                    - type: custom:button-card
                      template: scenario-button
                      name: üåÖ R√©veil
                      icon: mdi:weather-sunny
                      tap_action:
                        action: call-service
                        service: script.scenario_reveil
                        confirmation:
                          text: Lancer le sc√©nario r√©veil ?
                      styles:
                        card:
                          - background: >-
                              linear-gradient(135deg, rgba(255, 193, 7, 0.9),
                              rgba(255, 152, 0, 0.8))
                          - border: 2px solid rgba(255, 193, 7, 0.8)
                    - type: custom:button-card
                      template: scenario-button
                      name: üåô Coucher
                      icon: mdi:weather-night
                      tap_action:
                        action: call-service
                        service: script.scenario_coucher
                        confirmation:
                          text: Lancer le sc√©nario coucher ?
                      styles:
                        card:
                          - background: >-
                              linear-gradient(135deg, rgba(63, 81, 181, 0.9),
                              rgba(103, 58, 183, 0.8))
                          - border: 2px solid rgba(63, 81, 181, 0.8)
                    - type: custom:button-card
                      template: scenario-button
                      name: üè† Absent
                      icon: mdi:home-export-outline
                      tap_action:
                        action: call-service
                        service: script.scenario_absent
                        confirmation:
                          text: Activer le mode absent ?
                      styles:
                        card:
                          - background: >-
                              linear-gradient(135deg, rgba(244, 67, 54, 0.9),
                              rgba(233, 30, 99, 0.8))
                          - border: 2px solid rgba(244, 67, 54, 0.8)
                    - type: custom:button-card
                      template: scenario-button
                      name: üéâ F√™te
                      icon: mdi:party-popper
                      tap_action:
                        action: call-service
                        service: script.scenario_fete
                        confirmation:
                          text: Lancer le mode f√™te ?
    badges: []
  - type: sections
    max_columns: 4
    title: M√©t√©o int√©rieure
    path: meteo-interieure
    sections:
      - type: grid
        cards:
          - type: heading
            heading: Nouvelle section
          - type: thermostat
            entity: climate.rez_de_chaussee
          - type: thermostat
            entity: climate.chambres
            show_current_as_primary: true
          - type: thermostat
            entity: climate.adele
